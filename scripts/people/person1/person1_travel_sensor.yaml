alias: person1 travel sensor
sequence:
  - service: input_text.set_value
    data_template:
      entity_id: input_text.person_person1
      value: >-
        {% if is_state('input_boolean.person1_home', 'on') %} 
          {{ states('input_select.person1_status_dropdown') }}
        {% elif is_state('device_tracker.person1_mobile', 'home') and is_state('input_boolean.person1_home', 'off') %}
          Near home ({{ states('input_select.person1_status_dropdown') }})
        {% elif not is_state('device_tracker.person1_mobile', 'not_home') %}
          At {{ states('device_tracker.person1_mobile') }}
        {% elif states('proximity.person1_home')|int > 4000 %}
          {{ state_attr('sensor.person1s_time_to_home', 'duration')|round(0) }} {{ state_attr('sensor.person1s_time_to_home_by_bus', 'unit_of_measurement') }} to home by car
        {% elif states('proximity.person1_home')|int > 1500 %}
          {{ state_attr('sensor.person1s_time_to_home_by_bus', 'duration')|round(0) }} {{ state_attr('sensor.person1s_time_to_home_by_bus', 'unit_of_measurement') }} to home by bus
        {% elif states('proximity.person1_home')|int > 50 %}
          {{ state_attr('sensor.person1s_time_to_home_by_foot', 'duration')|round(0) }} {{ state_attr('sensor.person1s_time_to_home_by_foot', 'unit_of_measurement') }} to home on foot
        {% else %}
          Near home ({{ states('proximity.person1_home')|int}} meters away)
        {% endif %}
